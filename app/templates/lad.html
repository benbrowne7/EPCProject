<html>
    {% extends "base.html" %}
{% block head %}
{% block refresh %}
{% endblock %}
    {{super()}}
{% endblock %}



<body>


{% block dimen %} 
{{super()}}
{% endblock %} 

    {% block nav %}
    {{super()}}
    {% endblock %}

    {% block popupstart %} 

    <div id="popup">
        <div class="alert alert-dark alert-dismissible fade show" role="alert" id="alert">
            Welcome to the Heat Pump Ready App. <br>
            -> Chrome + Firefox for the Best Experience <br>
            -> Hit 'Reset' if any issues encountered <br>
            -> Link to Projects Documentation in bottom right of the page
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        
        <script>
            const showMsg = localStorage.getItem('hideAlert');
            if(showMsg === 'false'){
              $('.alert').hide();
            }
            $('.btn-close').on('click', function(){
              localStorage.setItem('hideAlert', 'false');
            });
            
        </script>
    </div>

    {% endblock %} 

{% block basicmap %}
{% endblock %}





{% block contentboxleft %}

<div class="contentboxleft">

    {% if epc_string1 is not defined %}
    <div class="toprightbox">
        <div id="switchheading" style="position:absolute; top:50%; transform: translateY(-50%); margin-left: 2%; font-size: 1.8vw;" >UK Energy Performance</div>
        <div class="switchmapbuttons" style="position: absolute; top:50%; transform: translateY(-50%);"><button type="button" class="btn btn-dark btn-sm me-2" ta-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Maps showing average EPC (energy performance) and HPR (heat pump readiness) for Districts in England and Wales" onclick="bigmap();">UK Energy Performance</button><button type="button" class="btn btn-dark btn-sm" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Maps Heat Pump Adoption Levels for Districts in England and Wales" onclick="adoptionmap();">UK Heat Pump Adoption</button></div>
    </div>
    <div class="ladboxmapresponse">
        <iframe src="/bigmap" id="bigmap" scrolling="no" ALLOWTRANSPARENCY="false"></iframe>
    </div>
    

    {% else %}
  
    <div class="toprightbox">
        <div class="heading" style="position:absolute; top:50%; transform: translateY(-50%); margin-left: 2%; font-size: 1.8vw;" >{{name}} Map</div>
        <select class="form-select form-select-sm" style="position: absolute; top:50%; transform: translateY(-50%); right: 2%; width:30%;" name="ladmapform" id="ladmapform" onchange="ChangeLAD(this.value);">
            <option value="1">Postcode District Map</option>
            <option value="2">Postcode Sector Map</option>
        </select>
    </div>
    

    <div class="ladboxmapresponse">
        <iframe src="/laddistrict" id="bigmap" scrolling="no" ALLOWTRANSPARENCY="false"></iframe>
    </div>
    

    {% endif %}
</div>
{% endblock %}

{% if valid1 is defined %}
        {% if valid1 == False %}
        <script>alert("Could not match LAD to ONS code");</script>
        {% endif %}
    {% endif %}

<div class="contentbox1">

    {% block topcontent %}
    <div class="toprightbox">
        <form class="form-inline form-control-sm" action="/ladreq" style="position: absolute; top:50%; transform: translateY(-50%); margin-left: 1%;"  method="post" required id="ladreqform">
            <div class="input-group">
                <input type="text" class="form-control me-1" id="ladreq" name="ladreq" placeholder="ONS CODE">
                <button type="submit" form="ladreqform" class="btn btn-primary btn-sm">Find LAD</button>
            </div>
          </form>
        {% if valid is defined %}
            {% if valid == False %}
            <script>alert("Invalid ONS Code");</script>
            {% endif %}
            {% endif %}

        <form class="form-inline form-control-sm" method="post" action="/ladsingle" style="position: absolute; top:50%; transform: translateY(-50%); margin-left: 50%;" id="singlelad">
            <div class="input-group">
            <select class="form-select me-1" name="singlelad" id="singlelad">
            {% for o in names %}
                <option value="{{o}}" SELECTED>{{o}}</option>
            {% endfor %}
            </select>
            <button type="submit" class="btn btn-primary btn-sm" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Returns Energy Performance for the selected district">Request LAD Info</button>
            </div>
        </form>
    </div>
    {% endblock %}



    {% block apireturn %}

            {% if epc_string1 is defined %}
            <div id="responseboxright">
            <div class="singleinfo">
                <div class="switchtabbuttons"><button type="button" class="btn btn-primary btn-sm me-2" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="View Energy Performance for the district" onclick="ladperf();">{{name}} Energy Perf</button><button type="button" class="btn btn-primary btn-sm" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="View Heat Pump Adoption Data for the district" onclick="ladadoption();">{{name}} Heat Pump Adoption</button></div>
                
                <div id="grid-link" style="position: absolute; top:0%; right:0%;">
                    <form action="/gridsingle" method="POST" target="_blank">
                        <input type="hidden" name="singlegrid" value="{{constit_name}}"><br><br>
                        <button class="btn btn-danger btn-sm me-2" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Check Grid Availability for this District" type="submit" formmethod="post">Check Grid Data</button>
                      </form></div>

                <div class="heading">Averages over all Local Authority Districts</div>
                <div class="responsetext">Average EPC: {{LAD_EPC_MEAN}} <span><i class="bi bi-info-circle icon-blue" data-bs-toggle="tooltip" data-bs-title="Average EPC Rating for all Local Authority Districts (England and Wales)"></i></span></div>
                <div class="responsetext">Average HPR: {{LAD_HPR_MEAN}} <span><i class="bi bi-info-circle icon-blue" data-bs-toggle="tooltip" data-bs-title="Average HPR Rating for all Local Authority Districts (England and Wales)"></i></span></div>
                <hr style="width:101%; height:4px; margin-left:-1%; background-color: black;  position:relative; margin-top: 1%;" />
                <div class="heading" style="margin-top:-1%;" >Comparing {{name}} ({{ons}}) to other Local Authority Districts</div> <div class="responsetext" >{{epc_string1}}</div>
                <div class="responsetext">{{hpr_string1}}</div>

                <div class="responsetext" >{% if tag1 == 0 %} <span class="notvalid">{{epc_string2}}</span> <span><i class="bi bi-info-circle icon-blue" data-bs-toggle="tooltip" data-bs-title="How the district compares to others based on EPC Rating"></i></span> {% elif tag1 == 1 %} <span class="orange">{{epc_string2}}</span> <span><i class="bi bi-info-circle icon-blue" data-bs-toggle="tooltip" data-bs-title="How the district compares to others based on EPC Rating"></i></span> {% elif tag1 == 2 %} <span class="valid">{{epc_string2}}</span> <span><i class="bi bi-info-circle icon-blue" data-bs-toggle="tooltip" data-bs-title="How the district compares to others based on EPC Rating"></i></span> {% endif %}</div>

                <div class="responsetext" >{% if tag2 == 0 %} <span class="notvalid">{{hpr_string2}} <span><i class="bi bi-info-circle icon-blue" data-bs-toggle="tooltip" data-bs-title="How the district compares to others based on HPR Rating"></i></span> </span> {% elif tag2 == 1 %} <span class="orange">{{hpr_string2}}</span> <span><i class="bi bi-info-circle icon-blue" data-bs-toggle="tooltip" data-bs-title="How the district compares to others based on HPR Rating"></i></span> {% elif tag2 == 2 %} <span class="valid">{{hpr_string2}}</span> <span><i class="bi bi-info-circle icon-blue" data-bs-toggle="tooltip" data-bs-title="How the district compares to others based on HPR Rating"></i></span> {% endif %} </div>

                <div class="responsetext" style="color:blue;">{{proportion_string}}</div>
                <div class="responsetext" style="color:blue;">{{exp_str}}</div>
            </div></div>
        {% else %}
            {{ super() }}
        {% endif %}
    {% endblock %}


    {% block apicontent1 %}
    {% if epc_string1 is defined %}
    <div id="responseboxright1">

            {% if ons is defined %}
                <iframe src="/graphpane" width=100% height=100% scrolling="no" id="graphpane" style="margin-top: 1%; margin-left: 1%;"></iframe>

            {% endif %}
    </div>

   {% endif %}
    {% endblock %}


</div>

{% block footer %}
{{super()}}
{% endblock %}

{% block redirect %}
{% endblock %}

    
 

</body>
</html>


